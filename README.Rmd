---
title: "Integrating geographic analysis in transport planning"
# title: "Integrating geographic analysis in transport planning workflows: the role of open source software
author: "Robin Lovelace"
date: '`r Sys.Date()`'
output:
  github_document: default
  pdf_document: default
  word_document: default
bibliography: references.bib
---

```{r, echo=FALSE, eval=FALSE}
# get citations
# refs_est = RefManageR::ReadZotero(group = "418217", .params = list(collection = "ABALWWZN", limit = 100))
# RefManageR::WriteBib(refs_est, "trafficEstimatr.bib")
refs_sof = RefManageR::ReadZotero(group = "418217", .params = list(collection = "JFR868KJ", limit = 100))
refs_gis = RefManageR::ReadZotero(group = "418217", .params = list(collection = "KUXG5CJL", limit = 100))
refs_geo = RefManageR::ReadZotero(group = "418217", .params = list(collection = "9K6FRP6N", limit = 100))
refs_tds = RefManageR::ReadZotero(group = "418217", .params = list(collection = "R38L2EXB", limit = 100))
refs = c(refs_sof, refs_gis, refs_geo, refs_tds)
refs_df = as.data.frame(refs)
# View(refs_df)
RefManageR::WriteBib(refs, "references.bib")
# citr::tidy_bib_file(rmd_file = "README.Rmd", messy_bibliography = "references.bib") # fails
library(tidyverse)

n_words = wordcountaddin::word_count("README.Rmd")
word_count = readr::read_csv("word-count.csv")
word_count_new = rbind(word_count, data.frame(date = Sys.Date(), n_words))
readr::write_csv(word_count_new, "word-count.csv")
ggplot(word_count_new) +
  geom_line(aes(date, n_words)) +
  xlim(as.Date(c("2019-01-01", "2020-01-01"))) +
  ylim(0, 5000)
```

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```



# Abstract {-}

Software for working with geographic data has long been used in transport planning.
Transport is an inherently geographic activity, involving movement through space, along more or less complicated trajectories defined by ways that can be defined as a spatial network.
There is a strong case for geography being an *inbuilt* part of transport planning software, yet a dichotomy between 'geographic' and 'non-geographic' components persists.
<!-- workflows in academic, public sector and private consultancy transport planning contexts still tend to separate vital geographic processing and map making stages from the rest of the analysis. -->
This paper argues that this division inadvertently damages transport planning in three main ways, by:
(1) reducing researcher effectiveness due to the time-consuming process of 'context switching';
(2) inhibiting reproducibility, requiring installation and management of geographic and non-geographic tools; and 
(3) reducing the visibility of vital geographic components in transport planning, with consequences for transport policy design.
Building on this critique, this paper outlines solutions that use popular and free open source software ecosystems (R, Python and QGIS) to embed geographic data analysis, modelling and visualisation to be *embedded within* transport planning workflows.
Ultimately, by highlighting cost effective and geographically targetted interventions, integrating geographic analysis in transoport planning could lead to better decision making.
<!-- and support the global efforts to transition away from fossil fuels and towards a healthy, low carbon transport system. -->

# Introduction

Transport planning is an applied discipline involving the design of physical infrastructure, including highways, railways, cycleways and footways [@oflaherty_transport_1997].
It also involves 'visioning' transport futures and making the economic and political case for change [@timms_imagineering_2014].
Successful transport plans are long-term strategies guided by citywide, regional and even national visions that will have material benefits for people and the local and global environment for generations to come.
But transport plans are also inherently spatial: the ways and other pieces of transport infrastructure must *go somewhere* to optimise their ability to take people *where they want to go* [@rodrigue_geography_2013].

Transport planning is thus embedded within broad democratic processes *and* local geographic contexts.
Effective transport planning is inherently democratic because it determines about how public space is to be used, with impacts for generations to come.
If transport plans are developed by unacountable technocrats with little understanding of transport's impacts on other economies, the results can be severe: the transport system now is the "leading cause of death for children and young adults aged 5-29 years" through road traffic casualties alone, with 1.35 million people killed and tens of millions injured and disabled each year [@world_health_organization_global_2018].
The air pollution impacts could be even worse, with a growing body of research linking air pollution to Alzheimer's disease, lung cancer and heart disease among hundreds of millions of sufferers worldwide [@kampa_human_2008; @kilian_emerging_2018].
Transport is responsible for a quarter of global greenhouse gas emissions and growing [@harrison_environmental_2017], and is one of the hardest sectors to decarbonise [@moriarty_prospects_2008], meaning that evidence-based plans to reduce transport energy use is an urgent priority affecting the global population and especially the projected 1.4 billion people who will live in low elevation (less than 10 m above sea level) coastal zones by 2060 [@neumann_future_2015].

Despite their global impacts, transport systems and the networks of physical infrastructure that underpin them are also highly localised [@barthelemy_spatial_2011; @levinson_network_2012] and to some degree dynamic [@xie_evolving_2011] phenomena.
This growing understanding of the fundamental nature of transport planning as a *spatial activity*, coupled with an upsurge in the amount of geographic transport data available, could explain why relative levels of interest in Transport Geography has grown over the last decade against a backdrop of low and falling levels of interest in purely geographic concepts such as 'geographic information systems' and 'geocomputation', at least according to data from Google Trends.
Figure 1, generated using reproducible code thanks to the **gtrendsR** R package [@massicotte_gtrendsr:_2019], suggests that inferred interest in Transport Geography may surpass inferred interest in GIS within the next few years, notwithstanding the limitations associated with search data [@mellon_internet_2014]. 

```{r, eval=FALSE}
library(gtrendsR)
# res_all <- gtrends(c("transport geography", "geographic information systems", "geocomputation"), time = "all")
res <- gtrends(c("transport geography", "geographic information systems", "spatial planning"), time = "2010-01-01 2019-06-01")
head(res$interest_over_time)
unique(res$interest_over_time$keyword)
nrow(res$interest_over_time) / 3 / 12
res$interest_over_time$date = rep(seq(from = as.Date("2010-01-01"), to = as.Date("2019-06-01"), length.out = 114), 3)
start_rows = 1
end_rows = nrow(res$interest_over_time) / 3

res$interest_over_time$hits_smoothed = c(
  zoo::rollmean(res$interest_over_time$hits[start_rows:end_rows], 6, fill = "extend"),
  zoo::rollmean(res$interest_over_time$hits[(start_rows:end_rows) + end_rows], 6, fill = "extend"),
  zoo::rollmean(res$interest_over_time$hits[(start_rows:end_rows) + 2 * end_rows], 6, fill = "extend")
)
ggplot(res$interest_over_time) +
  geom_line(aes(date, hits_smoothed, colour = keyword)) +
  ylab("Relative number of hits")
ggplot2::ggsave("google-trends.png")
```

```{r, fig.cap="Relative level of interest in search terms related to 'geographic information systems', 'geocomputation' and 'transport geography' inferred from google search data."}
knitr::include_graphics("google-trends.png")
```

The concept of integrating geographic data analysis in transport planning is not new.
Geographic perspectives have contributed to the transport planning for over 100 years, as documented in papers on geographic considerations in railway design [@buxton_balkan_1908] and national engineering challenges [@farnham_relation_1912], to take just a couple of pre-war examples.
In the interwar period (1918-1939)...
Around the turn of the century, there were attempts to define geographic information systems for transportation (GIS-T) as a self-standing academic field [@miller_potential_1999], something that has not caught on.

<!-- something on the Journal of Transport Geography? -->

The growing research interest in the subject is also reflected in teaching.
Modules dedicated to Transport Geography have been advertised at the Universities of Aberdeen and Hofstra and, at the University of Leeds the Masters module Sustainable Spatial Planning and Analysis ([SSPA](https://github.com/ITSLeeds/SSPA)) is focussed on GIS skills for transport planning (declaration of interest: I teach on this module).
There are evem dedicated 3 year degrees Transport Geography.
<!-- something on the lack of open source? -->

<!-- https://www.abdn.ac.uk/registry/courses/undergraduate/2016-2017/geography/gg4016
https://people.hofstra.edu/jean-paul_rodrigue/course_transport.html
 in Geography with Transport Studies BA advertised by the University of Leeds
-->

Where is existing infrastructure and 'demand' (current and potential travel) located?
How will transport patterns shift in the future?
And where will different types of intervention be most effective?
Tools that can help answer these questions are becoming an increasingly important part of the transport planner's cabinet [@te_brommelstroet_developing_2008].

To illustrate this point, imagine fundamental changes that could be made to tax system in support a transition away from fossil fuels.
Interventions such as carbon taxes would undoubtedly have geographic implications, but the intervention itself (charging a fixed price for the extraction and sale of atmosphere polluting substances) could be essentially non-geographic.
Notwithstanding changes to national policies relating to transport, transport planning interventions, by contrast, are inherently spatial.
Even high level national plans for a walking and cycling revolution must be implemented locally, down to the level of streets, as illustrated by the still ongoing local implementation of Dutch cycling ambitions [@pucher_making_2008]. 
The political-democratic and local-geographic aspects of transport planning can be considered in isolation, but an integrated approach is necessary for effective policies [@hull_policy_2008].
This is well illustrated by prominent Mayoral transport policies in cities such as 
London[^1],
Paris^[
The current Mayor of Paris, Anne Hidalgo, sees transport as a priority and has plans to make public transport free. See 
[paris.fr](https://www.paris.fr/rechercher/transport).
],
and Bogotá^[
Bogotá has an innovative and prominent transport policy, led by the two times mayor Enrique Peñalosa, who has led the roll-out of major bus and cycleway projects in the city. See [sitp.gov.co](https://www.sitp.gov.co/).
].


[^1]: Transport is a major electoral issue in London and the current Mayor, Sadiq Kahn, has made tackling air pollution a policy priority. See [tfl.gov.uk/corporate/about-tfl/the-mayors-transport-strategy](https://tfl.gov.uk/corporate/about-tfl/the-mayors-transport-strategy).

With such issues --- climate change, air pollution, obesity and social inequalities --- high on the political agenda, and the benefits for 'early adopters' of evidence-based interventions to accelerate the shift away from the motor car in cities such as London, Paris and Bogotá, pressure is growing on local, city and national transport planning departments to act.
But what should they do?
This *policy* question raises important *research* questions:
Which methods are most suitable for designing future transport systems?
What is the evidence base, and analysis, that should be used to inform transition towards a healthy, zero carbon transport system?
Which interventions, from the multitude of options available, are most likely to be effective?
And where are different types of intervention most likely to succeed?
The premise of this paper is that new approaches, enabled by software, are needed to provide answers to these questions.
21^st^ century demands for transport planning cannot be delivered by 20^th^ century technology and, this paper will argue, open source solutions are poised to bridge the gap between the geographic and the --- historically dominant --- non-geographic aspects of transport planning.
The 21^st^ Century also requires new transport planning methodologies which, as this paper outlines, increasingly involves geographic analysis.
Furthermore, the policy context increasingly demands transparency and citizen involvement in the decision-making process, which only software that is open source and reliably deliver, making an exploration of open source options for transport planning workflows timely.

Methods for transport planning are by no means static.
They are constantly evolving in response to policy drivers and technological change [@boyce_forecasting_2015].
Of course, transport policies that are evidence-based and grounded in realistic models of change under different scenarios of the future are far more likely to be successful than policies based on ideological commitment and good intentions alone.
With unprecedented access to increasingly detailed datasets on transport behaviours and infrastructure, transport planners today can make their designs are more evidence-based that ever, provided they have access to tools that enable them to make sense of this 'data revolution' [@transport_systems_catapult_transport_2015].
The sheer volume and complexity of new datasets suggest approaches that can scale and integrate multiple sources are needed [@lovelace_big_2016].
Furthermore, advances in software and hardware allow not only for current transport systems to be modelled at high temporal and geographic resolution, but for future scenarios and 'model experiments' to be developed, which can support identification and implementation of the most effective interventions [@klosterman_what_1999].
With the explosion in open source software, which has come to dominate data science, there is now also a unique opportunity for transport planning to become a more transparent and democratically accountable enterprise.

This dream of data driven, participatory and open transport planning has yet to emerge.
Transport planning as a discipline has been slow to adapt to the data revolution and, while it evolves to enable a wider range of input data sources and analysis 'in the cloud', the open source element of the dream is conspicuously lacking.
<!-- This stuff could go in the introduction. -->
The paper traces how this undesirable situation has arisen due to historical specialisation and monopolisation of transport planning software, based on existing literature and an understanding of landscape of tools used in practice (covered in the next section), before outlining an integrated approach that combines data analysis and geographic processing stages in a single workflow.
Three software ecosystems (R, Python and QGIS) are reviewed in detail; alternative current and potential future approaches, including 'cloud lock in' are discussed; and the relative merits of different approaches are discussed.
Building on this discussion, the paper concludes by returning to the importance of integrating data analysis and geographic processing in a single analysis.
This final section also outlines concrete steps that researchers, public sector transport planners, and transport planning analysts and consultants can take to accelerate the transition to open source software in transport planning which will, in turn, support policies that accelerate the transition to a healthy and zero carbon transport system.

<!-- The paper concludes that 'integrated approach' can support efficient, scalable and reproducible transport planning workflows which can provide a strong and transparent evidence base needed for rapid transition away from fossil fuels in the transport sector. -->

# The landscape of transport planning software

The geographic and non-geographic division of labour in Transport Planning

Data preprocessing and analysis stages are generally done in dedicated transport planning and spreadsheet software.
Geographic analysis and cartographic visualisation stages are generally done in a dedicated 'geographic information system' (GIS).


# Tools for integrated geographic analysis

## R

[@r_core_team_r:_2019]

[@bivand_implementing_2006]

[@pebesma_software_2015]


[@bivand_applied_2013]


## Python

[@rossum_python_1995]


## QGIS

[@qgis_development_team_qgis_2019]

# Conclusion

# References
